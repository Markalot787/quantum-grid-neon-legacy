<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Quantum Grid: Neon Legacy</title>
		<link rel="icon" href="/favicon.ico" />
		<link
			href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap"
			rel="stylesheet"
		/>
		<!-- Post-processing libraries -->
		<script
			type="module"
			src="https://cdn.jsdelivr.net/npm/three@0.157.0/examples/jsm/postprocessing/EffectComposer.js"
		></script>
		<script
			type="module"
			src="https://cdn.jsdelivr.net/npm/three@0.157.0/examples/jsm/postprocessing/RenderPass.js"
		></script>
		<script
			type="module"
			src="https://cdn.jsdelivr.net/npm/three@0.157.0/examples/jsm/postprocessing/UnrealBloomPass.js"
		></script>
		<script
			type="module"
			src="https://cdn.jsdelivr.net/npm/three@0.157.0/examples/jsm/postprocessing/ShaderPass.js"
		></script>
		<style>
			body {
				margin: 0;
				overflow: hidden;
				font-family: 'Orbitron', sans-serif;
				background-color: #000;
				color: #fff;
			}
			canvas {
				display: block;
			}
			#game-container {
				position: absolute;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				z-index: 0;
			}
			#info {
				position: absolute;
				top: 10px;
				width: 100%;
				text-align: center;
				color: #0cf;
				z-index: 100;
				pointer-events: none;
				text-shadow: 0 0 10px rgba(0, 204, 255, 0.7);
			}
			#score {
				position: absolute;
				top: 10px;
				left: 10px;
				color: #fff;
				z-index: 100;
				pointer-events: none;
				font-size: 18px;
				text-shadow: 0 0 10px rgba(0, 204, 255, 0.7);
			}
			#level {
				position: absolute;
				top: 40px;
				left: 10px;
				color: #fff;
				z-index: 100;
				pointer-events: none;
				font-size: 18px;
				text-shadow: 0 0 10px rgba(0, 204, 255, 0.7);
			}
			#cubes-left {
				position: absolute;
				top: 70px;
				left: 10px;
				color: #fff;
				z-index: 100;
				pointer-events: none;
				font-size: 18px;
				text-shadow: 0 0 10px rgba(0, 204, 255, 0.7);
			}
			#lives {
				position: absolute;
				top: 100px;
				left: 10px;
				color: #fff;
				z-index: 100;
				pointer-events: none;
				font-size: 22px;
			}
			.heart-icon {
				margin-right: 5px;
				animation: pulse 1.5s infinite ease-in-out;
			}
			.heart-icon.empty {
				opacity: 0.4;
				animation: none;
			}
			@keyframes pulse {
				0% {
					transform: scale(1);
				}
				50% {
					transform: scale(1.1);
				}
				100% {
					transform: scale(1);
				}
			}
			#controls {
				position: absolute;
				bottom: 10px;
				width: 100%;
				text-align: center;
				color: #fff;
				z-index: 100;
				pointer-events: none;
				text-shadow: 0 0 10px rgba(0, 204, 255, 0.7);
			}
			#payment-modal {
				position: fixed;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				background-color: rgba(0, 0, 0, 0.8);
				display: flex;
				justify-content: center;
				align-items: center;
				z-index: 30;
				backdrop-filter: blur(5px);
			}
			#payment-container {
				background-color: rgba(10, 10, 42, 0.9);
				padding: 30px;
				border-radius: 10px;
				max-width: 500px;
				width: 90%;
				text-align: center;
				border: 2px solid #00ffff;
				box-shadow: 0 0 20px rgba(0, 255, 255, 0.7);
			}
			#payment-container h2 {
				color: #fff;
				margin-top: 0;
				text-shadow: 0 0 10px #00ffff, 0 0 20px #00ffff;
			}
			#payment-container p {
				margin-bottom: 20px;
				color: #ccc;
			}
			#gameOverScreen {
				display: none;
				position: fixed;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				background-color: rgba(0, 0, 0, 0.7);
				z-index: 1000;
				color: white;
				text-align: center;
				opacity: 0;
				transition: opacity 0.5s ease;
				font-family: 'Orbitron', sans-serif;
			}
			#gameOverScreen.active {
				opacity: 1;
			}
			#gameOverScreen div {
				position: absolute;
				top: 50%;
				left: 50%;
				transform: translate(-50%, -50%);
			}
			#gameOverScreen h1 {
				font-size: 42px;
				margin-bottom: 20px;
				color: #ff3366;
				text-shadow: 0 0 15px rgba(255, 51, 102, 0.7);
			}
			#gameOverScreen button {
				padding: 10px 20px;
				background-color: #0cf;
				color: #001428;
				border: none;
				border-radius: 4px;
				cursor: pointer;
				margin-top: 20px;
				font-size: 18px;
				font-family: 'Orbitron', sans-serif;
				font-weight: bold;
				transition: all 0.2s ease;
			}
			#gameOverScreen button:hover {
				background-color: #00e6ff;
				box-shadow: 0 0 10px rgba(0, 204, 255, 0.7);
				transform: scale(1.05);
			}
			#markedTile {
				position: absolute;
				bottom: 40px;
				right: 10px;
				color: #fff;
				z-index: 100;
				font-size: 18px;
				text-shadow: 0 0 10px rgba(0, 204, 255, 0.7);
			}
			#tutorial {
				display: none;
				position: fixed;
				top: 50%;
				left: 50%;
				transform: translate(-50%, -50%);
				background-color: rgba(0, 20, 40, 0.9);
				border: 2px solid #0cf;
				padding: 30px;
				border-radius: 5px;
				width: 500px;
				color: #fff;
				z-index: 2000;
				box-shadow: 0 0 20px rgba(0, 204, 255, 0.5);
				text-align: center;
				font-family: 'Orbitron', sans-serif;
			}
			#tutorial h2 {
				color: #0cf;
				margin-top: 0;
			}
			.cube-info {
				display: flex;
				justify-content: space-between;
				margin: 20px 0;
			}
			.cube-info div {
				text-align: center;
				flex: 1;
			}
			.cube-icon {
				display: inline-block;
				width: 30px;
				height: 30px;
				margin-bottom: 5px;
			}
			.normal-cube {
				background-color: #aaa;
			}
			.forbidden-cube {
				background-color: #000;
				border: 1px solid #333;
			}
			.advantage-cube {
				background-color: #0f0;
			}
			.key-info {
				display: flex;
				flex-wrap: wrap;
				justify-content: center;
				margin-top: 20px;
			}
			.key-item {
				margin: 5px 10px;
			}
			.key {
				display: inline-block;
				padding: 5px 10px;
				background-color: #001428;
				border: 1px solid #0cf;
				border-radius: 3px;
				margin-right: 5px;
			}
			#ui {
				position: absolute;
				top: 0;
				left: 0;
				width: 100%;
				padding: 20px;
				box-sizing: border-box;
				pointer-events: none;
				z-index: 10;
			}
			#score-container {
				display: flex;
				justify-content: space-between;
				align-items: center;
				margin-bottom: 10px;
			}
			#score,
			#level {
				font-size: 24px;
				font-weight: bold;
				text-shadow: 0 0 10px #00ffff, 0 0 20px #00ffff, 0 0 30px #00ffff;
				color: #fff;
			}
			#game-over,
			#start-screen {
				position: absolute;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				display: flex;
				flex-direction: column;
				justify-content: center;
				align-items: center;
				background-color: rgba(0, 0, 0, 0.8);
				z-index: 20;
			}
			#game-over h1,
			#start-screen h1 {
				font-size: 48px;
				margin-bottom: 20px;
				text-align: center;
				text-transform: uppercase;
				letter-spacing: 3px;
				color: #fff;
				text-shadow: 0 0 10px #ff00ff, 0 0 20px #ff00ff, 0 0 30px #ff00ff;
				animation: neon-pulse 1.5s infinite alternate;
			}
			#game-over p,
			#start-screen p {
				font-size: 24px;
				margin-bottom: 30px;
				text-align: center;
				max-width: 600px;
				color: #ccc;
			}
			button {
				font-family: 'Orbitron', sans-serif;
				font-size: 18px;
				padding: 12px 30px;
				background-color: transparent;
				color: #00ffff;
				border: 2px solid #00ffff;
				border-radius: 4px;
				cursor: pointer;
				transition: all 0.3s;
				text-transform: uppercase;
				letter-spacing: 2px;
				margin: 10px;
				pointer-events: auto;
				position: relative;
				overflow: hidden;
				box-shadow: 0 0 10px #00ffff, 0 0 20px rgba(0, 255, 255, 0.5);
			}
			button:hover {
				background-color: rgba(0, 255, 255, 0.2);
				box-shadow: 0 0 15px #00ffff, 0 0 30px rgba(0, 255, 255, 0.7);
				transform: translateY(-2px);
			}
			button:active {
				transform: translateY(1px);
			}
			#instructions {
				position: absolute;
				bottom: 20px;
				left: 20px;
				background-color: rgba(0, 0, 0, 0.7);
				padding: 15px;
				border-radius: 5px;
				border: 1px solid #00ffff;
				box-shadow: 0 0 10px rgba(0, 255, 255, 0.5);
				max-width: 300px;
				pointer-events: auto;
			}
			#instructions h3 {
				margin-top: 0;
				color: #00ffff;
				text-shadow: 0 0 5px #00ffff;
			}
			#instructions p {
				margin: 5px 0;
				font-size: 14px;
			}
			.cube-type {
				display: flex;
				align-items: center;
				margin-bottom: 5px;
			}

			.cube-color {
				width: 15px;
				height: 15px;
				margin-right: 10px;
				border: 1px solid #fff;
			}

			.red {
				background-color: #ff0000;
				box-shadow: 0 0 5px #ff0000;
			}
			.green {
				background-color: #00ff00;
				box-shadow: 0 0 5px #00ff00;
			}
			.blue {
				background-color: #0000ff;
				box-shadow: 0 0 5px #0000ff;
			}
			.yellow {
				background-color: #ffff00;
				box-shadow: 0 0 5px #ffff00;
			}
			.black {
				background-color: #000;
				border: 1px solid #ff00ff;
				box-shadow: 0 0 5px #ff00ff;
			}

			@keyframes neon-pulse {
				from {
					text-shadow: 0 0 10px #ff00ff, 0 0 20px #ff00ff, 0 0 30px #ff00ff;
				}
				to {
					text-shadow: 0 0 5px #ff00ff, 0 0 10px #ff00ff, 0 0 15px #ff00ff,
						0 0 20px #ff00ff, 0 0 35px #ff00ff;
				}
			}
		</style>
	</head>
	<body>
		<!-- Game container -->
		<div id="game-container"></div>

		<!-- UI Elements -->
		<div id="info">Quantum Grid: Neon Legacy</div>
		<div id="score">Score: <span id="score-value">0</span></div>
		<div id="level">Level: <span id="level-value">1</span></div>
		<div id="cubes-left">Cubes: <span id="cubes-value">0</span></div>
		<div id="lives">
			<span class="heart-icon">❤️</span>
			<span class="heart-icon">❤️</span>
			<span class="heart-icon">❤️</span>
		</div>
		<div id="markedTile">Marked: <span id="marked-value">None</span></div>
		<div id="controls">
			WASD/Arrows: Move | Space: Mark/Capture | R: Activate Advantage | C:
			Toggle Camera
		</div>

		<!-- Game Over Screen -->
		<div id="gameOverScreen">
			<div>
				<h1>Game Over</h1>
				<p>Your final score: <span id="final-score">0</span></p>
				<button id="restart-button">Play Again</button>
			</div>
		</div>

		<!-- Start Screen -->
		<div id="startScreen" class="screen">
			<div>
				<h1>Quantum Grid: Neon Legacy</h1>
				<p>Capture cubes before they fall off the edge!</p>
				<button id="start-button">Start Game</button>
				<button id="tutorial-button">How to Play</button>
			</div>
		</div>

		<!-- Tutorial Screen -->
		<div id="tutorial">
			<h2>How to Play</h2>
			<p>
				Control your character on the quantum platform and capture cubes before
				they fall off the edge.
			</p>
			<div class="cube-info">
				<div>
					<div class="cube-icon normal-cube"></div>
					<p>Normal Cubes</p>
					<small>Capture these before they fall off</small>
				</div>
				<div>
					<div class="cube-icon forbidden-cube"></div>
					<p>Forbidden Cubes</p>
					<small>Do NOT capture these - they shrink your platform</small>
				</div>
				<div>
					<div class="cube-icon advantage-cube"></div>
					<p>Advantage Cubes</p>
					<small>Capture and use these to clear 3x3 areas</small>
				</div>
			</div>
			<p>
				<strong>Controls:</strong><br />
				WASD or Arrow Keys: Move player<br />
				Space: Mark/capture cube<br />
				R: Activate advantage cube (3x3 area clear)<br />
				C: Toggle camera animation<br />
				ESC: Pause game
			</p>
			<button id="close-tutorial">Got it!</button>
		</div>

		<!-- Pause Screen -->
		<div id="pauseScreen" class="screen">
			<div>
				<h1>Game Paused</h1>
				<button id="resume-button">Resume</button>
				<button id="quit-button">Quit</button>
			</div>
		</div>

		<!-- Payment Modal -->
		<div id="payment-modal" style="display: none">
			<div id="payment-container">
				<h2>Unlock Full Game</h2>
				<p>
					You've played the free trial! Unlock the full game to continue your
					progress and access all features.
				</p>
				<div id="payment-form">
					<!-- Payment form will be inserted here by Stripe -->
				</div>
				<button id="cancel-payment">Cancel</button>
			</div>
		</div>

		<!-- Scripts -->
		<script src="https://js.stripe.com/v3/"></script>
		<script type="module" src="main.js"></script>
	</body>
</html>
